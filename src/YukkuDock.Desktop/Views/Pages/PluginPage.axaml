<UserControl
  x:Class="YukkuDock.Desktop.Views.PluginPage"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:epoxy="https://github.com/kekyo/Epoxy"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:ui="using:FluentAvalonia.UI.Controls"
  xmlns:vm="using:YukkuDock.Desktop.ViewModels"
  d:DesignHeight="450"
  d:DesignWidth="800"
  epoxy:Fountain.Well="{Binding PageWell}"
  epoxy:Anchor.Pile="{Binding PagePile}"
  x:DataType="vm:PluginPageViewModel"
  mc:Ignorable="d"
  >
  <UserControl.DataContext>
    <vm:PluginPageViewModel />
  </UserControl.DataContext>
  <DockPanel Margin="10">
    <Grid
      Margin="0,0,0,10"
      HorizontalAlignment="Stretch"
      ColumnDefinitions="Auto, *"
      DockPanel.Dock="Top"
      >
      <TextBlock
        Grid.Column="0"
        VerticalAlignment="Center"
        Text="プラグイン管理"
        Theme="{StaticResource SubtitleTextBlockStyle}"
        />

      <StackPanel
        Grid.Column="1"
        HorizontalAlignment="Right"
        Orientation="Horizontal"
        >
        <Button
          Margin="5,2,0,2"
          HorizontalAlignment="Right"
          Command="{Binding OpenPluginFolderCommand}"
          IsEnabled="{Binding CanOpenPluginFolder}"
          >
          <StackPanel Orientation="Horizontal">
            <ui:SymbolIcon
              Margin="0,0,5,0"
              FontSize="16"
              Symbol="OpenFolder"
              />
            <TextBlock Text="プラグインフォルダ開く" />
          </StackPanel>
        </Button>

        <Button
          Margin="5,2,0,2"
          HorizontalAlignment="Right"
          Command="{Binding UpdatePluginsCommand}"
          IsEnabled="{Binding CanOpenPluginFolder}"
          >
          <StackPanel Orientation="Horizontal">
            <ui:SymbolIcon
              Margin="0,0,5,0"
              FontSize="16"
              Symbol="Refresh"
              />
          </StackPanel>
        </Button>
      </StackPanel>


    </Grid>
    <StackPanel
      MinWidth="150"
      Background="{DynamicResource SolidBackgroundFillColorTertiaryBrush}"
      DockPanel.Dock="Right"
      >
      <StackPanel.Styles>
        <Style Selector="StackPanel &gt; :is(Button)">
          <Setter Property="Margin" Value="5, 2" />
          <Setter Property="HorizontalAlignment" Value="Stretch" />
        </Style>
      </StackPanel.Styles>
      <Button Content="Add Plugin" />
      <Button Content="Add Plugin" />
      <SplitButton>
        <SplitButton.Flyout>
          <ui:FAMenuFlyout>
            <!--  use the GroupName property to group radio items together  -->
            <ui:RadioMenuFlyoutItem
              GroupName="BackupGroup"
              IsChecked="True"
              Text="選択中のプラグイン"
              />
            <ui:RadioMenuFlyoutItem
              GroupName="BackupGroup"
              IsChecked="True"
              Text="全プラグイン"
              />
          </ui:FAMenuFlyout>
        </SplitButton.Flyout>
        <StackPanel Orientation="Horizontal">
          <ui:SymbolIcon
            Margin="0,0,5,0"
            FontSize="16"
            Symbol="Delete"
            />
          <TextBlock Text="バックアップ" />
        </StackPanel>
      </SplitButton>
      <Button>
        <StackPanel Orientation="Horizontal">
          <ui:SymbolIcon
            Margin="0,0,5,0"
            FontSize="16"
            Symbol="Delete"
            />
          <TextBlock Text="削除" />
        </StackPanel>
      </Button>
    </StackPanel>

    <TreeDataGrid Source="{Binding PluginsSource}"
      IsEnabled="{Binding !IsUpdatingPlugins}">
      <AdornerLayer.Adorner>
        <Grid>
          <Border
            Background="Black"
            Opacity="0.5"
            HorizontalAlignment="Stretch"
            VerticalAlignment="Stretch"
            IsVisible="{Binding IsUpdatingPlugins}"
            >
            <ui:ProgressRing
              Width="80" Height="80"
              IsIndeterminate="True"
              ZIndex="10"
            />
          </Border>

        </Grid>
      </AdornerLayer.Adorner>

      <TreeDataGrid.Styles>
        <Style Selector="TreeDataGrid TreeDataGridRow:nth-child(2n)">
          <Setter Property="Background" Value="{DynamicResource CardBackgroundFillColorSecondaryBrush}" />
        </Style>

        <Style Selector="TreeDataGridRow">
          <Setter Property="MinHeight" Value="24" />
          <Setter Property="Padding" Value="2,0" />
        </Style>

        <Style Selector="TreeDataGridCell">
          <Setter Property="Padding" Value="4,0" />
        </Style>

        <Style Selector="TreeDataGridCell TextBlock, TreeDataGridCell ToggleSwitch">
          <Setter Property="Margin" Value="0" />
        </Style>

      </TreeDataGrid.Styles>

    </TreeDataGrid>

  </DockPanel>
</UserControl>
